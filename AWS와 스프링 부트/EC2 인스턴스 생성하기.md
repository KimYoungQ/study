AWS EC2를 이용한 서버 배포를 시작하며
===

<br/>

**`스프링 부트와 AWS로 혼자 구현하는 웹서비스`** 란 책을 통해 만든 프로젝트를 AWS라는 클라우드 서비스를 이용해 서버 배포를 하려고 한다. `IaaS(Infrastructure as a Service)`중 하나인 `EC2(Elastic Compute Cloud)`를 사용할 예정이다. 먼저 IaaS란 기존 물리 장비를 *미들웨어*와 함께 묶어둔 추상화 서비스며 가상머신, 스토리지, 네트워크, 운영체제등의 IT 인프라를 대여해준다. 그리고 사용할 EC2의 장점으로는 다음과 같다.

> E2의 장점
> * 용량을 늘리거나 줄일 수 있다. (탄력성)
> * 사용한만큼 지불하므로 저렴하다.
> * 사용자가 *인스턴스*를 완전히 제어할 수 있다.
> * 보안 및 네트워크 구성, 스토리지 관리 효과적이다.

<br/>

그럼 이제 본격적으로 EC2 인스턴스를 생성해 보자.

<br/>




EC2 인스턴스 생성하기
---

<br/>

먼저 화면상단 리전을 서울로 설정하자

![Inked리전 설정_LI](https://user-images.githubusercontent.com/45932388/110195750-e2bfc900-7e82-11eb-8221-00b29c900b2f.jpg)

<br/>




### 1단계 . *AMI* 생성하기

![AMI선택](https://user-images.githubusercontent.com/45932388/110194820-1d733280-7e7e-11eb-8738-52718f0ca77a.PNG)



Amazon Linux 2 AMI (HVM), SSD Volume Typefmf 선택해주자

<br/>


### 2단계 . 인스턴스 유형선택

![인스턴스유형선택](https://user-images.githubusercontent.com/45932388/110195990-b5741a80-7e84-11eb-854f-1c1c21c85fb6.PNG)

프리티어로 표기된 t2.micro를 선택한다.

<br/>

### 3단계 . 인스턴스 세부 정보 구성

혼자서 1대의 서버만 사용하기 때문에 별다른 설정 없이 넘어간다.

<br/>

### 4단계 . 스토리지 추가

![4단계_스토리지추가](https://user-images.githubusercontent.com/45932388/110196102-975aea00-7e85-11eb-9292-848da7909efb.PNG)

프리티어는 30GB까지 가능하므로 설정

<br/>

### 5단계 . 태그 추가

![5단계_태그추가](https://user-images.githubusercontent.com/45932388/110196323-1270d000-7e87-11eb-8426-5a8e96ab3178.PNG)

태그에는 웹 콘솔에서 표기될 태그인 Name 태그를 등록한다. (EC2의 이름을 붙인다고 생각하면 된다)
여러 인스턴스가 있을 경우 이를 태그별로 구분하면 검색이나 그룹 짓기 편하므로 본인 서비스의 인스턴스를 나타낼 수 있는 값으로 등록한다.

<br/>

### 6단계 . 보안그룹구성

![6단계_보안그룹구성](https://user-images.githubusercontent.com/45932388/110196317-097ffe80-7e87-11eb-94fa-cf5d289f6616.PNG)

유형 항목에서 SSH이면서 포트항목에서 22인 경우는 AWS EC2에 터미널로 접속할 때를 이야기하는데 전체 오픈(0.0.0.0/0, ::/0)하는 경우 pem 키가 노출되 위험하다. 지정된 IP로만 접속 가능하도록 한다. 그리고 현재 포트인 8090을 추가한다. 그리고 시작하기 클릭!

<br/>

### 7단계 . pem 키 생성

![7단계_pem키생성](https://user-images.githubusercontent.com/45932388/110196409-a17de800-7e87-11eb-8d6d-42854338fdb3.PNG)

pem 키가 없는 경우 생성, 일종의 마스터 키이기 때문에 절대로 유출되면 안된다.

<br/>

### 인스턴스 생성 완료

![인스턴스생성완료](https://user-images.githubusercontent.com/45932388/110196528-75af3200-7e88-11eb-831b-97815b70b064.PNG)

생성이 다 되었다면 다음과 같이 IP와 도메인이 할당된 것을 확인할 수 있다.

<br/>

### 인스턴스 고정 IP 설정

![탄력적IP발급](https://user-images.githubusercontent.com/45932388/110196672-74323980-7e89-11eb-814f-a507cb7ba9bb.PNG)

같은 인스턴스를 중지하고 다시 시작할 때 새 IP가 할당되므로 PC에서 접근할 때마다 IP 주소를 확인해야 한다. 그러므로 매번 변경되지 않고 고정 IP를 가지게 설정해준다.
AWS의 고정 IP를 Elastic IP(EIP, 탄력적 IP)라고 한다. 좌측 메뉴의 탄력적 IP에 들어가 탄력적 IP주소할당을 클릭해 발급해 주도록 하자.

![탄력적주소연결](https://user-images.githubusercontent.com/45932388/110196746-edca2780-7e89-11eb-8cac-e08e5b756e71.PNG)

작업란의 탄력적 주소 IP연결을 선택해 탄력적주소를 연결해준다. 다음 인스턴스로 들어가 탄력적 주소가 제대로 적용되었는지 확인해준다.

>탄력적 IP는 무조건 EC2에 바로 연결해야한다. 연결하지 않으면 비용 발생!!

<br/>

---

용어설명

* `미들웨어` : 컴퓨터 제작 회사가 사용자의 요구대로 만들어 제공하는 프로그램으로, 운영 체제와 응용 소프트웨어의 중간에서 조정과 중개의 역할을 수행하는 소프트웨어이다.
* `인스턴스` : EC2 서비스에 생성된 가성머신이다.
* `AMI(Amazon Machine Image)` : EC2 인스턴스를 시작하느데 필요한 정보를 이미지로 만들어 둔 것이다. 


